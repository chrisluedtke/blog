<!DOCTYPE html>
<html lang="en">

  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-116548426-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-116548426-1');
    </script>

    <!-- meta -->
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta name="description" content="ChiPy Mentorship Blog 3 of 3"/>
    <meta name="author" content="Chris Luedtke"/>
    <meta property="og:title" content="The Ultimate Day of Chicago Bikeshare" />
    <meta property="og:type" content="blog" />
    <meta property="og:description" content="An anlysis of 17 million rides" />
    <meta property="og:image" content="img/chipy_finale.jpg" />

    <title>The Ultimate Day of Chicago Bikeshare</title>

    <!-- random CSS -->
    <style>
      .center-fit {
         max-width: 100%;
         max-height: 100%;
         margin: auto;
      }
    </style>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- Custom styles for this template -->
    <link href="css/clean-blog.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">

  </head>

  <body>

    <!-- Navigation -->
     <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
      <div class="container">
        <a class="navbar-brand"></a>
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          Menu
          <i class="fa fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://github.com/chrisluedtke">GitHub</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/in/c-luedtke/l">LinkedIn</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="mailto:chrisluedtke@gmail.com">Contact</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Page Header -->
    <header class="masthead" style="background-image: url('img/chipy_finale.jpg')">
      <div class="overlay"></div>
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-md-10 mx-auto">
            <div class="post-heading">
              <h1>The Ultimate Day of Chicago Bikeshare</h1>
              <h2 class="subheading">ChiPy Mentorship Finale</h2>
              <span class="meta">February 8, 2019</span>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Post Content -->
    <article>
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-md-10 mx-auto">

              <p>Each day, Chicago&apos;s utilitarian design enables an incredible flow of people. Perhaps nothing bears this out better than the ridership of millions of bikes over several years. In this article, I analyze 17 million bikeshare rides and animate the most representative day of Chicago bikeshare. Skip ahead for the pretty pictures.</p>
              <h3 id="chicago-biking">Chicago Biking</h3>
              <p>Bicycles are the best way to see a city, and yes, I am including Chicago&apos;s sometimes brutal winter months. Even as temperatures approached <a href="https://darksky.net/details/41.8756,-87.6244/2019-1-30/us12/en">-50&#xB0;F last week</a>, our bikeshare <a href="https://twitter.com/DivvyBikes/status/1091398529975836673">received ridership</a>.</p>
              <p>Our blissfully flat terrain, lakefront paths, and bike infrastructure investments landed us Bicycling Magazine&apos;s <a href="https://www.bicycling.com/news/a20048181/the-50-best-bike-cities-of-2016/">most bike-friendly city in the country</a> (6th in <a href="https://www.bicycling.com/culture/a23676188/best-bike-cities-2018/">2018</a>). This past December, Chicago completed <a href="https://www.chicagoparkdistrict.com/parks-facilities/lakefront-trail">$12 million</a> and <a href="http://www.navypierflyover.com/">$60 million</a> projects to secure 18 continuous miles of dedicated lakefront bike path through the heart of Chicago.</p>
              <h3 id="data-sourcing">Data Sourcing</h3>
              <p>With mounting excitement for Chicago&apos;s cyclist future, I devoted my past week to a thorough shakedown of our bikeshare&apos;s <a href="https://www.divvybikes.com/system-data">public datasets</a>. You can find the code for this analysis on  <a href="https://github.com/chrisluedtke/divvy-data-analysis">GitHub</a>, including a <a href="https://nbviewer.jupyter.org/github/chrisluedtke/divvy-data-analysis/blob/master/notebook.ipynb">notebook</a> that steps through my process.</p>
              <p>My first step was writing a <a href="https://github.com/chrisluedtke/divvy-data-analysis/tree/master/divvy">python package</a> to load the data neatly. Here&apos;s the result, pulling in ~2 GB of data:</p>
              <pre><code class="language-python">import pandas as pd

              import divvy

              rides, stations = divvy.historical_data.get_data(
                  year=[str(_) for _ in range(2013,2019)],
                  rides=True,
                  stations=True
              )

              rides.to_pickle(&apos;data/rides.pkl&apos;)
              stations.to_pickle(&apos;data/stations.pkl&apos;)</code></pre>
              <p>Divvy data come in <code>zip</code> files grouped by quarter. Columns and date formats are not standardized across files, so I manually wrote them into the loading process.</p>
              <p>Most challenging, the ride tables don&apos;t include geographic coordinates for ride origin and destination. That information is tied to stations, which are contained in their own files. Divvy also didn&apos;t provide station information at all for 2018, so I integrated data from their <a href="https://feeds.divvybikes.com/stations/stations.json">live JSON station feed</a> to get the most recent locations.</p>
              <p>I also discovered stations had been physically moved while maintaining the same row-level ID. This greatly reduces the certainty of geographic analysis, as I can only be certain of a station&apos;s location at the end of the quarter on which the data were published. I calculated the geographic distance between these movements over time and dropped movements below a ~50 meter <a href="https://en.wikipedia.org/wiki/Decimal_degrees#Precision">precision level</a>.</p>
              <p>A representative station:</p>
              <table border="1" class="dataframe">
                <thead>
                  <tr style="text-align: right;">
                    <th>id</th>
                    <th>latitude</th>
                    <th>longitude</th>
                    <th>online_date</th>
                    <th>source</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>2</td>
                    <td>41.872293</td>
                    <td>-87.624091</td>
                    <td>NaT</td>
                    <td>2015</td>
                  </tr>
                  <tr>
                    <td>2</td>
                    <td>41.881060</td>
                    <td>-87.619486</td>
                    <td>2013-06-10 10:43:46</td>
                    <td>2017_Q1Q2</td>
                  </tr>
                  <tr>
                    <td>2</td>
                    <td>41.876393</td>
                    <td>-87.620328</td>
                    <td>2013-06-10 10:43:00</td>
                    <td>2017_Q3Q4</td>
                  </tr>
                </tbody>
              </table>

              <p>All duplicate stations and their movements:</p>
              <p><strong>map of moved stations</strong></p>
              <p>Ultimately I decided to average the remaining station coordinates. I didn&apos;t suspect the difference would make a meaningful impact on my analysis.</p>
              <h4 id="descriptives">Descriptives</h4>
              <p>With cleaned data, the beauty of the information could finally shine. There really are countless, never-ending lines of inquiry one may follow in this data set, and I suspect this won&apos;t be my final analysis.</p>
              <p>For starters, since June 2013 there have been <strong>17.5 million trips</strong>, totaling <strong>5.3 million</strong> hours, and covering between <strong>21.7</strong> (haversine) and <strong>27.1</strong> (taxi cab) <strong>million miles</strong>. That&apos;s 56 trips to the moon and back!</p>
              <p>The typical ride lasted <strong>11.7 minutes</strong> and covered between <strong>1.0</strong> and <strong>1.2 miles</strong>. The longest ride covered between <strong>22.9</strong> and <strong>26.2 miles</strong> in <strong>2.9 hours</strong>.</p>
              <p>The typical bike was ridden <strong>2.8 thousand</strong> times for <strong>820 hours</strong>.</p>
              <p>The longest ridden bike covered between <strong>6.5</strong> and <strong>8.1 thousand miles</strong>. Here&apos;s a map of all its routes.</p>
              <iframe src="divvy-data/moved_stations.html" width="100%" height="200" scrolling="no" frameborder="0"></iframe>

              <h4 id="time-series-analysis">Time Series Analysis</h4>
              <p>Ultimately I set out to characterize and visualize Chicago&apos;s bikeshare usage. Due to Chicago&apos;s layout, I suspected this line of analysis would return fascinating results.</p>
              <p>To investigate, I took all 2,017 days of data, cut them into 30 minute segments, and calculated statistics for each station within those timeframes across all days. In particular, I was interested in each station&apos;s net arrivals and departures. For each station, I added those numbers and divided by the number of days the station had been active.</p>
              <p>This gave me 48 &apos;snapshots&apos; of Chicago bikeshare activity, each representing a separate typical 30 minute period of the day. To animate this data more smoothly, I interpolated up to 720 frames to give &apos;snapshots&apos; representing 2 minutes of the day.</p>
              <p>Here&apos;s the result.</p>
              <p><iframe width="560" height="315" src="https://www.youtube.com/embed/SVueGQPpz14&amp;autoplay=1&amp;loop=1&amp;rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>

              <p>Winter vs Summer plot</p>

          </div>
        </div>
      </div>
    </article>

    <!-- Footer -->

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/clean-blog.min.js"></script>

  </body>

</html>
